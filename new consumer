try:
    for message in consumer:
        ts = datetime.fromtimestamp(message.timestamp / 1000.0)
        logging.info(
            f"Partition: {message.partition}, Offset: {message.offset}, Timestamp: {ts}, Valeur: {message.value.decode('utf-8')}"
        )
    logging.info("Aucun nouveau message apr√®s 10 secondes. Fin du script.")
finally:
    consumer.close()
