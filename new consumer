# Verifier les offsets
partitions = consumer.partitions_for_topic(topic)
if partitions:
    for partition in partitions:
        tp = TopicPartition(topic, partition)
        consumer.assign([tp])
        end_offset = consumer.position(tp)
        logger.info(f"Partition: {partition}, End offset: {end_offset}")

try:
    for message in consumer:
        logger.info(f"Message reçu: Offset={message.offset}, Timestamp={message.timestamp}")
        consumer.commit()  # Commit explicite après lecture
except KafkaError as e:
    logger.error(f"Erreur Kafka: {e}")
finally:
    consumer.close()
