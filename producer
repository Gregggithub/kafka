                message = {"index": i, "ligne": ligne}
                try:
                    future = producer.send(TOPIC, key=i, value=message)
                    # On attend le résultat pour détecter les erreurs
                    record_metadata = future.get(timeout=10)
                    print(f"[✓] Message {i} envoyé : partition={record_metadata.partition}, offset={record_metadata.offset}")

                except Exception as send_error:
                    print(f"❌ Erreur lors de l'envoi du message {i} : {send_error}")
                    traceback.print_exc()
                    # Optionnel : continuer ou interrompre selon le besoin
                    # break

                time.sleep(DELAY)
